<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Speed AudioReader</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body data-theme="dark">
<canvas id="stage"></canvas>

<!-- Progress / Waveform bar -->
<div class="progressWrap">
  <div class="progressTopRow">
    <span id="currentTime">0:00</span>
    <span id="bookTitle" class="book-title">Loading...</span>
    <span id="timeLeft">0:00</span>
  </div>
  <div class="progressBar" id="progressBar" role="slider"
       aria-label="Progress" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" tabindex="0">
    <div id="progressFill" class="progressFill" style="width:0%"></div>
  </div>
  <div class="progressBottomRow">
    <span id="wordCounter" class="word-counter"></span>
    <span id="statusMsg" class="status-msg"></span>
  </div>
</div>

<!-- Controls -->
<div class="controls">
  <div class="playbackRow">
    <button id="resetBtn" class="icon-btn" aria-label="Reset to beginning" title="Reset">⟲</button>
    <button id="back10Btn" class="icon-btn" aria-label="Back 10 seconds" title="-10s">⏪</button>
    <button id="playBtn" class="playBtn icon-btn" aria-label="Play/Pause">
      <span id="playIcon" aria-hidden="true">▶</span>
      <span id="pauseIcon" aria-hidden="true" hidden>⏸</span>
    </button>
    <button id="fwd10Btn" class="icon-btn" aria-label="Forward 10 seconds" title="+10s">⏩</button>
    <button id="settingsBtn" class="icon-btn settings-btn" title="Settings" aria-label="Settings">⚙</button>
  </div>

  <div class="speedRow">
    <label for="speedRange" class="speed-label">Speed:</label>
    <button id="speedDown" class="icon-btn small-btn" aria-label="Decrease speed">−</button>
    <input id="speedRange" type="range" min="0.25" max="3.0" step="0.05" value="1.0">
    <button id="speedUp" class="icon-btn small-btn" aria-label="Increase speed">+</button>
    <span id="speedLabel" class="speed-value">1.0×</span>
  </div>

  <div class="volumeRow">
    <label class="speed-label">Vol:</label>
    <input id="volumeRange" type="range" min="0" max="1" step="0.05" value="1.0">
    <span id="volumeLabel" class="speed-value">100%</span>
  </div>
</div>

<!-- Settings Modal -->
<div id="settingsBackdrop" class="modal-backdrop">
  <div class="modal">
    <button class="modalCloseX" id="closeSettings" aria-label="Close settings">×</button>
    <strong>Settings</strong>

    <div class="themeGrid">
      <div class="themeRow">
        <label for="bgColor">Background</label>
        <div style="display:flex;gap:10px;align-items:center;">
          <input id="bgColor" type="color" value="#000000">
          <input id="bgHex" type="text" placeholder="#000000" class="hex-input">
        </div>
      </div>
      <div class="themeRow">
        <label for="fgColor">Text</label>
        <div style="display:flex;gap:10px;align-items:center;">
          <input id="fgColor" type="color" value="#ffffff">
          <input id="fgHex" type="text" placeholder="#ffffff" class="hex-input">
        </div>
      </div>
      <div class="themeRow">
        <label for="focusColor">Focus letter</label>
        <div style="display:flex;gap:10px;align-items:center;">
          <input id="focusColor" type="color" value="#ff2a2a">
          <input id="focusHex" type="text" placeholder="#ff2a2a" class="hex-input">
        </div>
      </div>
      <div class="themeRow">
        <label for="fontScaleRange">Font scale</label>
        <div style="display:flex;gap:10px;align-items:center;">
          <input id="fontScaleRange" type="range" min="0.25" max="3.00" step="0.05" value="1.0">
          <span id="fontScaleLabel">1.0</span>
        </div>
      </div>
      <div class="themeRow">
        <label for="contextToggle">Show context</label>
        <button id="contextToggle" class="toggle-btn">Off</button>
      </div>
    </div>

    <div class="modalRow">
      <button id="themeResetBtn">Reset</button>
      <button id="themeApplyBtn">Apply</button>
    </div>
  </div>
</div>

<!-- Loading overlay -->
<div id="loadingOverlay" class="loading-overlay">
  <div class="loading-content">
    <div class="spinner"></div>
    <p id="loadingText">Loading alignment data...</p>
  </div>
</div>

<script src="app.js"></script>
</body>
</html>
